@startuml  oauth2-authorization-code

UpdateElementStyle(System, $fontColor="#282a3a", $borderColor="#9496a1",  $bgColor="#f3f4f8")
UpdateRelStyle("#b3b5bd", "#b3b5bd")

AddRelTag("dashedLine", $lineStyle = DashedLine())


partecipant Client as Client
pertecipant Resource Owner as ResourceOwner
partecipant Authorization Server as AuthorizationServer
partecipant Resource Server as ResourceServer

ResourceOwner -> Client : Richiesta di acceso 
Client -> AuthorizationServer 
AuthorizationServer -> ResourceOwner
ResourceOwner -> AuthorizationServer
AuthorizationServer -> Applicazione Client


System(Client, "Client", "")
System(ResourceOwner, "Resource Owner", "")
System(AuthorizationServer, "Authorization Server", "")
System(ResourceServer, "Resource Server", "")

Rel(Client, ResourceOwner, "(1) Richiesta autorizzazione", $tags="dashedLine")
Rel(ResourceOwner, Client, "(2) Authorization Grant", $tags="dashedLine")

Rel(Client, AuthorizationServer, "(3) Authorization Grant", $tags="dashedLine")
Rel(AuthorizationServer, Client, "(4) Access Token", $tags="dashedLine")

Rel(Client, ResourceServer,"(5) Access Token", $tags="dashedLine")
Rel(ResourceServer, Client,"(6) Risorsa protetta", $tags="dashedLine")

HIDE_STEREOTYPE()
@enduml


